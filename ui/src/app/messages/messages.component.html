<nav class="flex-header">
	<a class="nav-item" [routerLink]="['/conversations']">
		<arrow left="true" height="20" width="10" color="rgb(21, 126, 251)"></arrow>
	</a>
	<div *ngIf="conversation" class="nav-item title">
		<anonymous size="50"></anonymous><br />{{ conversation.to | whom }}</div>
	<a *ngIf="conversation" class="nav-item text-right" (click)="showConversationSettings = true"><strong class="fancy-letter">i</strong></a>
	<div *ngIf="!conversation" class="nav-item text-right"></div>
</nav>
<div *ngIf="messages" id="content" (click)="selectedMessage = null" [ngClass]="{'imessage': conversation && conversation.protocol === 'imessage'}">
	<div *ngFor="let message of messages | before: playbackIndex" class="message-container">
		<div *ngIf="message.ts" class="timestamp">
			<strong *ngIf="index === 0">{{ (conversation && conversation.protocol === 'imessage') ? 'iMessage' : 'Text Message' }}</strong><br
				*ngIf="index === 0" />
			<strong>{{ message.ts | friendlyDate: true }}</strong> {{ message.ts | date: 'h:mm a' }}
		</div>
		<div (click)="isRecording() && (selectedMessage = message); $event.stopPropagation()" [ngClass]="{'message': true, 'outbound': message.outbound, 'active': selectedMessage === message}">{{ message.content }}</div>
		<callout left="!message.outbound"></callout>
		<div class="clearfix"></div>
	</div>
	<div *ngIf="isReceivingMessage" class="message-container">
		<div class="message">...</div>
		<div class="clearfix"></div>
	</div>
</div>
<footer *ngIf="!selectedMessage">
	<div *ngIf="!inputFocused" class="flex-links">
		<i class="camera-icon links-item"></i>
		<i class="gesture-icon links-item"></i>
		<i class="apps-icon links-item"></i>
	</div>
	<i *ngIf="inputFocused" class="rounded-rect"></i>
	<div class="fancy-input">
		<input #messageContent class="actual-input" type="text" [placeholder]="(conversation && conversation.protocol === 'imessage') ? 'iMessage' : 'Text Message'"
			(focus)="inputFocused = true" (blur)="inputFocused = false" [disabled]="isReceivingMessage" />
		<i [ngClass]="{'active': inputFocused, 'send-icon': true, 'imessage': (conversation && conversation.protocol === 'imessage')}"
			(click)="sendMessage(messageContent.value); messageContent.value = ''"></i>
	</div>
</footer>
<footer *ngIf="selectedMessage" class="flex-links">
	<i [ngClass]="{'links-item': true, 'move-icon': true, 'left': selectedMessage.outbound, 'disabled': isPlayback()}" (click)="isRecording() && toggleOutbound(selectedMessage)"></i>
	<i [ngClass]="{'delete-icon': true, 'links-item': true, 'disabled': isPlayback()}" (click)="isRecording() && deleteMessage(selectedMessage)"></i>
	<i [ngClass]="{'rewind-icon': true, 'links-item': true, 'disabled': isPlayback()}" (click)="isRecording() && rewind(selectedMessage)"></i>
	<i [ngClass]="{'ff-icon': true, 'links-item': true, 'disabled': isRecording()}" (click)="isPlayback() && fastForward()"></i>
</footer>