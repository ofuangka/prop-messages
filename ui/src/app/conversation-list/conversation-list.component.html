<nav class="flex-header">
	<a class="nav-item">Edit</a>
	<div class="nav-item title">Messages</div>
	<a class="nav-item text-right" (click)="showNewMessage = true">New</a>
</nav>
<div class="content">
	<ul *ngIf="!showConversationListLoading" class="table">
		<li *ngFor="let conversation of conversations" (click)="showConversationDetail(conversation)">
			<div class="row">
				<img *ngIf="conversation.iconId" class="icon" [src]="getIconHref(conversation.iconId)" />
				<anonymous *ngIf="!conversation.iconId" class="icon" [size]="50"></anonymous>
				<div class="text">
					<div class="heading">
						<div class="to heading-item">{{ conversation.to | ellipsis: 25 }}</div>
						<div class="last-updated-ts grayish heading-item">{{ conversation.lastUpdatedTs | friendlyDate }}</div>
						<arrow></arrow>
					</div>
					<div class="summary grayish">{{ conversation.summary | ellipsis: 60 }}</div>
				</div>
			</div>
		</li>
	</ul>
	<div *ngIf="showConversationListLoading" class="loading">Loading...</div>
</div>
<div class="modal" *ngIf="showNewMessage">
	<nav class="flex-header">
		<a class="nav-item" (click)="imessage = false; showNewMessage = false">Cancel</a>
		<div class="nav-item title">New Message</div>
		<a *ngIf="!showNewMessageLoading" class="nav-item text-right" (click)="to.value && to.value.length > 0 && saveNewMessage(to.value, imessage)">Save</a>
		<a *ngIf="showNewMessageLoading" class="nav-item text-right">Loading...</a>
	</nav>
	<div class="content">
		<form id="new-message-form" class="form">
			<div id="to-line">
				<label class="to-item">To:</label><input #to class="to-item" />
			</div>
			<ul class="table">
				<li>
					<div class="row setting">
						<label>Use iMessage</label>
						<i [ngClass]="{'switch': true, 'on': imessage}" (click)="imessage = !imessage"><i class="peg"></i></i>
					</div>
				</li>
			</ul>
		</form>
	</div>
</div>